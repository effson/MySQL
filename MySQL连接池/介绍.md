## 1. MySQL 的 连接池（Connection Pool）的作用
### 1.1 减少连接开销
- 每次应用程序访问数据库，如果都要重新建立和释放连接，会产生很大的开销（TCP 三次握手、身份认证、资源分配等）。
- 连接池会预先建立一定数量的连接并放入池中，应用需要时直接复用现有连接，用完再归还，避免频繁创建和销毁

### 1.2 提高并发性能
- 在高并发场景下，如果每个请求都新建连接，数据库和操作系统都可能被拖垮。
- 连接池可以通过最大连接数来控制并发连接的数量，避免数据库被瞬间压垮，同时保证合理的资源利用

### 1.3. 资源复用与管理
连接池会对连接进行统一的生命周期管理，例如：
- 空闲连接保活（避免被数据库服务器回收）。
- 自动回收长时间未使用的连接。
- 健康检查（检测不可用连接并重建）。
- 可以保持连接的长期可用性，减少“死连接”问题

## 2.数据库连接池维持与数据库的连接
### 2.1 维持数据库连接（应用层面）
MySQL 连接是基于 TCP 套接字 的，会话建立后，客户端和 MySQL Server 之间维持一个逻辑连接。
即使应用层没有执行 SQL，这个连接依然存在。
#### 问题：
- 如果长时间没有交互，中间的防火墙 / NAT / 负载均衡设备可能会认为这个连接是“死的”，然后清理掉。
- MySQL 服务端也可能因为空闲超时 (wait_timeout / interactive_timeout) 主动断开
#### 解决方式：
- 定期执行 心跳 SQL（比如 SELECT 1），以确保连接仍然可用
- 借助 TCP keepalive，但更多是主动做 应用层心跳检查
- TCP keepalive主要作用是保证网络畅通
- 在没有 SQL 执行时，维持连接更多依赖连接池的心跳策略，定时发送用户态数据包

#### 约束
- server发送给MySQL的数据要符合MySQL协议
- server接收到的数据也需要解码，需要安装MySQL驱动
- MySQL驱动需要同时具有编码和解码的能力

#### MySQL驱动
- 官网：C/C++: libmysqlclient.lib /.dll   libmysqlclient.a/.so   mysql.h  阻塞io
- 自己实现，实现mysql协议的编码和解码  workflow\openrestry  非阻塞io
- 
